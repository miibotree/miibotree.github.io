<!doctype html>
<html class="theme-next use-motion theme-next-mist">
<head>
    

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.4"/>




  <meta name="keywords" content="Hexo,next" />





  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.4" />


<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Miibotree'thinking">
<meta property="og:url" content="http://yoursite.com/page/17/index.html">
<meta property="og:site_name" content="Miibotree'thinking">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Miibotree'thinking">
<meta name="twitter:description">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'post'
  };
</script>

    <title> Miibotree'thinking </title>
</head>
<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">
<!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->




<div class="container one-column 
   page-home 
">
    <div class="headband"></div>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand" rel="start">
      <span class="logo">
        <i class="icon-logo"></i>
      </span>
      <span class="site-title">Miibotree'thinking</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon icon-home"></i> <br />
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-archives"></i> <br />
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-tags"></i> <br />
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            <i class="menu-item-icon icon-about"></i> <br />
            关于
          </a>
        </li>
      
    </ul>
  

  
</nav>


        </div>
    </header>

    <main id="main" class="main">
        <div class="main-inner">
            <div id="content" class="content">
                
  <section id="posts" class="posts-expand">
    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2012/04/07/PE区块权限与createfile形参权限的区别/" itemprop="url">
                PE区块权限与createfile形参权限的区别
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2012-04-07T17:45:57+08:00" content="2012-04-07">
            2012-04-07
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>在PE文件结构中的区块表中的IMAGE_SECTION_HEADER结构体中有一个Characteristics属性，这个属性规定了区块的属性，该属性可以设置下面这些字段：</p>
<table><br><tbody><br><tr><br><th>Flag</th><br><th>Meaning</th><br></tr><br><tr><br><td><br><dl><br><dt>0&#215;00000000</dt><br></dl><br></td><br><td>Reserved.</td><br></tr><br><tr><br><td><br><dl><br><dt>0&#215;00000001</dt><br></dl><br></td><br><td>Reserved.</td><br></tr><br><tr><br><td><br><dl><br><dt>0&#215;00000002</dt><br></dl><br></td><br><td>Reserved.</td><br></tr><br><tr><br><td><br><dl><br><dt>0&#215;00000004</dt><br></dl><br></td><br><td>Reserved.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_TYPE_NO_PAD</dt><br><dt>0&#215;00000008</dt><br></dl><br></td><br><td>The section should not be padded to the next boundary. This flag is obsolete and is replaced by IMAGE_SCN_ALIGN_1BYTES.</td><br></tr><br><tr><br><td><br><dl><br><dt>0&#215;00000010</dt><br></dl><br></td><br><td>Reserved.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_CNT_CODE</dt><br><dt>0&#215;00000020</dt><br></dl><br></td><br><td>The section contains executable code.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_CNT_INITIALIZED_DATA</dt><br><dt>0&#215;00000040</dt><br></dl><br></td><br><td>The section contains initialized data.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_CNT_UNINITIALIZED_DATA</dt><br><dt>0&#215;00000080</dt><br></dl><br></td><br><td>The section contains uninitialized data.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_LNK_OTHER</dt><br><dt>0&#215;00000100</dt><br></dl><br></td><br><td>Reserved.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_LNK_INFO</dt><br><dt>0&#215;00000200</dt><br></dl><br></td><br><td>The section contains comments or other information. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>0&#215;00000400</dt><br></dl><br></td><br><td>Reserved.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_LNK_REMOVE</dt><br><dt>0&#215;00000800</dt><br></dl><br></td><br><td>The section will not become part of the image. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_LNK_COMDAT</dt><br><dt>0&#215;00001000</dt><br></dl><br></td><br><td>The section contains COMDAT data. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>0&#215;00002000</dt><br></dl><br></td><br><td>Reserved.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_NO_DEFER_SPEC_EXC</dt><br><dt>0&#215;00004000</dt><br></dl><br></td><br><td>Reset speculative exceptions handling bits in the TLB entries for this section.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_GPREL</dt><br><dt>0&#215;00008000</dt><br></dl><br></td><br><td>The section contains data referenced through the global pointer.</td><br></tr><br><tr><br><td><br><dl><br><dt>0&#215;00010000</dt><br></dl><br></td><br><td>Reserved.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_MEM_PURGEABLE</dt><br><dt>0&#215;00020000</dt><br></dl><br></td><br><td>Reserved.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_MEM_LOCKED</dt><br><dt>0&#215;00040000</dt><br></dl><br></td><br><td>Reserved.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_MEM_PRELOAD</dt><br><dt>0&#215;00080000</dt><br></dl><br></td><br><td>Reserved.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_ALIGN_1BYTES</dt><br><dt>0&#215;00100000</dt><br></dl><br></td><br><td>Align data on a 1-byte boundary. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_ALIGN_2BYTES</dt><br><dt>0&#215;00200000</dt><br></dl><br></td><br><td>Align data on a 2-byte boundary. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_ALIGN_4BYTES</dt><br><dt>0&#215;00300000</dt><br></dl><br></td><br><td>Align data on a 4-byte boundary. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_ALIGN_8BYTES</dt><br><dt>0&#215;00400000</dt><br></dl><br></td><br><td>Align data on a 8-byte boundary. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_ALIGN_16BYTES</dt><br><dt>0&#215;00500000</dt><br></dl><br></td><br><td>Align data on a 16-byte boundary. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_ALIGN_32BYTES</dt><br><dt>0&#215;00600000</dt><br></dl><br></td><br><td>Align data on a 32-byte boundary. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_ALIGN_64BYTES</dt><br><dt>0&#215;00700000</dt><br></dl><br></td><br><td>Align data on a 64-byte boundary. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_ALIGN_128BYTES</dt><br><dt>0&#215;00800000</dt><br></dl><br></td><br><td>Align data on a 128-byte boundary. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_ALIGN_256BYTES</dt><br><dt>0&#215;00900000</dt><br></dl><br></td><br><td>Align data on a 256-byte boundary. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_ALIGN_512BYTES</dt><br><dt>0x00A00000</dt><br></dl><br></td><br><td>Align data on a 512-byte boundary. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_ALIGN_1024BYTES</dt><br><dt>0x00B00000</dt><br></dl><br></td><br><td>Align data on a 1024-byte boundary. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_ALIGN_2048BYTES</dt><br><dt>0x00C00000</dt><br></dl><br></td><br><td>Align data on a 2048-byte boundary. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_ALIGN_4096BYTES</dt><br><dt>0x00D00000</dt><br></dl><br></td><br><td>Align data on a 4096-byte boundary. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_ALIGN_8192BYTES</dt><br><dt>0x00E00000</dt><br></dl><br></td><br><td>Align data on a 8192-byte boundary. This is valid only for object files.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_LNK_NRELOC_OVFL</dt><br><dt>0&#215;01000000</dt><br></dl><br></td><br><td>The section contains extended relocations. The count of relocations for the section exceeds the 16 bits that is reserved for it in the section header. If the NumberOfRelocations field in the section header is 0xffff, the actual relocation count is stored in theVirtualAddress field of the first relocation. It is an error if IMAGE_SCN_LNK_NRELOC_OVFL is set and there are fewer than 0xffff relocations in the section.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_MEM_DISCARDABLE</dt><br><dt>0&#215;02000000</dt><br></dl><br></td><br><td>The section can be discarded as needed.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_MEM_NOT_CACHED</dt><br><dt>0&#215;04000000</dt><br></dl><br></td><br><td>The section cannot be cached.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_MEM_NOT_PAGED</dt><br><dt>0&#215;08000000</dt><br></dl><br></td><br><td>The section cannot be paged.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_MEM_SHARED</dt><br><dt>0&#215;10000000</dt><br></dl><br></td><br><td>The section can be shared in memory.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_MEM_EXECUTE</dt><br><dt>0&#215;20000000</dt><br></dl><br></td><br><td>The section can be executed as code.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_MEM_READ</dt><br><dt>0&#215;40000000</dt><br></dl><br></td><br><td>The section can be read.</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_SCN_MEM_WRITE</dt><br><dt>0&#215;80000000</dt><br></dl><br></td><br><td>The section can be written to.</td><br></tr><br></tbody><br></table>

<p>这些标志字段通过或运算可以叠加。</p>
<p>比如</p>
<p>IMAGE_SCN_MEM_READ规定了可读权限</p>
<p>IMAGE_SCN_MEM_WRITE规定了可写权限</p>
<p>&nbsp;</p>
<p>然后我在打开PE文件的时候使用了CreateFile这个函数，这个函数定义如下：</p>
<p>&nbsp;</p>
<pre>HANDLE CreateFile(
  LPCTSTR lpFileName,
  DWORD dwDesiredAccess,
  DWORD dwShareMode,
  LPSECURITY_ATTRIBUTES lpSecurityAttributes,
  DWORD dwCreationDisposition,
  DWORD dwFlagsAndAttributes,
  HANDLE hTemplateFile
);</pre>

<p>HANDLE CreateFile(</p>
<div></div>

<p>LPCTSTR lpFileName, //指向文件名的指针</p>
<div></div>

<p>DWORD dwDesiredAccess, //访问模式（写/读）</p>
<div></div>

<p>DWORD dwShareMode, //共享模式</p>
<div></div>

<p>LPSECURITY_ATTRIBUTES lpSecurityAttributes, //指向安全属性的指针</p>
<div></div>

<p>DWORD dwCreationDisposition, //如何创建</p>
<div></div>

<p>DWORD dwFlagsAndAttributes, //文件属性</p>
<div></div>

<p>HANDLE hTemplateFile //用于复制文件句柄</p>
<div></div>

<p>);</p>
<div></div>

<p>然后我的问题就是：这里在函数CreateFile中的形参中规定了文件的权限，在PE结构中的Characteristics中又规定了区块的权限，那么这两个权限有什么区别呢？</p>
<p>&nbsp;</p>
<p>作为一个新手，怎么也想不明白这个问题。后来问了学长，终于揭开了我的疑惑：</p>
<p>首先在Chracteristics属性中规定的区块权限是在磁盘上的PE文件映射到了内存以后，如果要对内存中的PE区块进行可读可写等区块操作，这个时候就要用到这个Chracteristics属性了。</p>
<p>而在磁盘中的PE文件其实不过是一堆二进制数据。大家都知道在linux里面的话一切都是文件。把这个概念引申过来，那么在磁盘上PE文件和记事本的.txt其实是没有本质上的区别的，因为在计算机硬盘里存的就是一堆二进制代码的0和1.所以我们在CreateFile的时候在形参里面首先规定这个文件的读写权限，就可以对这个文件进行相应的操作了。</p>
<p>&nbsp;</p>
<p>其实这个问题想明白了是很简单的。-_-|||简单的说，就是Chracteristics属性规定了在内存中的读写权限，而CreateFile形参中的dwDesiredAccess规定了打开文件以后在磁盘中的读写权限。</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2012/04/04/PE格式之DOS头-PE头/" itemprop="url">
                PE格式之DOS头+PE头
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2012-04-04T19:30:03+08:00" content="2012-04-04">
            2012-04-04
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>清明节回来乘车到学校，没想到竟然做错了公交车。来回竟然多花了3个小时。。。。。。车子又挤。真的快无语了。</p>
<p>所以写下代码来泄愤。。。。</p>
<p>首先给大家推广下小甲鱼的网站</p>
<p><a href="http://fishc.com/" target="_blank" rel="external">http://fishc.com/</a>  小甲鱼是个大帅锅（。。。。）</p>
<p>这个网站做的很齐全，里面讲汇编，PE，破解等很多好的资源。小甲鱼的视频讲解也是很详细的。自己看完书再看一遍小甲鱼的视频，最后自己再写代码巩固一下，感觉学习效果还是不错的。</p>
<p>好吧，接下来就不说废话了。先发一张图片，这个是比较完整的PE结构。图片有点大貌似不太好看。</p>
<p><a href="http://miibotree.com/wp-content/uploads/2012/04/2009060617535490.gif" target="_blank" rel="external"><img src="http://miibotree.com/wp-content/uploads/2012/04/2009060617535490-1024x659.gif" alt="" title="2009060617535490"></a></p>
<p>然后从小甲鱼那里搞来的DOS头结构和PE头结构的数据结构如下（有中文翻译的）</p>
<p>IMAGE_DOS_HEADER STRUCT</p>
<p>{</p>
<p>+0h WORD e_magic    // Magic DOS signature MZ(4Dh 5Ah)     DOS可执行文件标记</p>
<p>+2h   WORD e_cblp    // Bytes on last page of file</p>
<p>+4h WORD e_cp    // Pages in file</p>
<p>+6h WORD e_crlc    // Relocations</p>
<p>+8h WORD e_cparhdr   // Size of header in paragraphs</p>
<p>+0ah WORD e_minalloc   // Minimun extra paragraphs needs</p>
<p>+0ch WORD e_maxalloc  // Maximun extra paragraphs needs</p>
<p>+0eh WORD e_ss            // intial(relative)SS value        DOS代码的初始化堆栈SS</p>
<p>+10h WORD e_sp     // intial SP value                       DOS代码的初始化堆栈指针SP</p>
<p>+12h WORD e_csum     // Checksum</p>
<p>+14h WORD e_ip     // intial IP value               DOS代码的初始化指令入口[指针IP]</p>
<p>+16h WORD e_cs     // intial(relative)CS value         DOS代码的初始堆栈入口</p>
<p>+18h WORD e_lfarlc     // File Address of relocation table</p>
<p>+1ah WORD e_ovno         // Overlay number</p>
<p>+1ch WORD e_res[4]      // Reserved words</p>
<p>+24h WORD e_oemid      // OEM identifier(for e_oeminfo)</p>
<p>+26h WORD      e_oeminfo   // OEM information;e_oemid specific</p>
<p>+29h WORD e_res2[10]   // Reserved words</p>
<p>+3ch DWORD   e_lfanew     //  Offset to start of PE header      指向PE文件头</p>
<p>} IMAGE_DOS_HEADER ENDS</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>首先是IMAGE_NT_HEADERS 结构的定义：（啥？结构不会，先看看小甲鱼童鞋的《零基础入门学习C语言》关于结构方面的章节吧~）</p>
<p>IMAGE_NT_HEADERS STRUCT</p>
<p>{</p>
<p>+0h       DWORDSignature</p>
<p>+4h       IMAGE_FILE_HEADER FileHeader</p>
<p>+18h     IMAGE_OPTIONAL_HEADER32OptionalHeader</p>
<p>} IMAGE_NT_HEADERS ENDS</p>
<p>&nbsp;</p>
<h2 id="Signature_字段：">Signature 字段：</h2><p>在一个有效的 PE 文件里，Signature 字段被设置为00004550h, ASCII 码字符是“PE00”。标志这 PE 文件头的开始。</p>
<p>“PE00” 字符串是 PE 文件头的开始，DOS 头部的 e_lfanew 字段正是指向这里。</p>
<p>如下图所示：<span style="color: #339966;"></span></p>
<p></p>
<div><img src="http://fishc.com/uploads/allimg/120113/9_120113221105_1.gif" alt="PE教程,PE视频教程,PE原理,PE头教程"></div>

<p>&nbsp;</p>
<h2 id="IMAGE_FILE_HEADER_结构">IMAGE_FILE_HEADER 结构</h2><p>typedef struct _IMAGE_FILE_HEADER</p>
<p>{</p>
<p>+04h WORD   Machine;   // 运行平台</p>
<p>+06h   WORD   NumberOfSections; // 文件的区块数目</p>
<p>+08h DWORD TimeDateStamp; // 文件创建日期和时间</p>
<p>+0Ch   DWORD PointerToSymbolTable; // 指向符号表(主要用于调试)</p>
<p>+10h DWORD NumberOfSymbols; // 符号表中符号个数(同上)</p>
<p>+14h   WORD   SizeOfOptionalHeader; // IMAGE_OPTIONAL_HEADER32 结构大小</p>
<p>+16h   WORD   Characteristics; // 文件属性</p>
<p>} IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;</p>
<p>&nbsp;</p>
<p>该结构如下图所示：</p>
<p><img src="http://fishc.com/uploads/allimg/120113/9_120113220446_1.gif" alt="PE教程,PE视频教程,PE原理,PE头教程"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2 id="下边，小甲鱼童鞋为大家详细解释各个成员的含义和用法：">下边，小甲鱼童鞋为大家详细解释各个成员的含义和用法：</h2><p>（1）Machine：可执行文件的目标CPU类型。<span style="font-family: 'Times New Roman'; font-size: medium;"></span></p>
<p></p>
<p>&nbsp;</p>
<div><br><table><br><tbody><br><tr><br><th>Value</th><br><th>Meaning</th><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_FILE_MACHINE_I386</dt><br><dt>0x014c  </dt><br></dl><br></td><br><td>x86</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_FILE_MACHINE_IA64</dt><br><dt>0&#215;0200</dt><br></dl><br></td><br><td>Intel Itanium</td><br></tr><br><tr><br><td><br><dl><br><dt>IMAGE_FILE_MACHINE_AMD64</dt><br><dt>0&#215;8664</dt><br></dl><br></td><br><td>x64</td><br></tr><br></tbody><br></table><br></div>

<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>（2）NumberOfSection: 区块的数目。（注：区块表是紧跟在 IMAGE_NT_HEADERS 后边的）</p>
<p>（3）TimeDataStamp: 表明文件是何时被创建的。</p>
<p>这个值是自1970年1月1日以来用格林威治时间（GMT） 计算的秒数，这个值是比文件系统（FILESYSTEM）的日期时间更加精确的指示器。如何将这个值翻译请 看：<a href="http://home.fishc.com/space.php?uid=9&amp;do=blog&amp;id=555" target="_blank" rel="external">http://home.fishc.com/space.php?uid=9&amp;do=blog&amp;id=555</a></p>
<p>提示：VC的话可以用_ctime 函数或者 gmtime 函数。</p>
<p>（4）PointerToSymbolTable: COFF 符号表的文件偏移位置，现在基本没用了。</p>
<p>（5）NumberOfSymbols: 如果有COFF 符号表，它代表其中的符号数目，COFF符号是一个大小固定的结构，如果想找到COFF 符号表的结束位置，则需要这个变量。</p>
<p>（6）SizeOfOptionalHeader: 紧跟着IMAGE_FILE_HEADER 后边的数据结构（IMAGE_OPTIONAL_HEADER）的大小。(对于32位PE文件，这个值通常是00E0h；对于64位PE32+文件，这个值是00F0h )。</p>
<p>（7）Characteristics: 文件属性，有选择的通过几个值可以运算得到。( 这些标志的有效值是定义于 winnt.h 内的 IMAGE_FILE_** 的值，具体含义见下表。普通的EXE文件这个字段的值一般是 0100h，DLL文件这个字段的值一般是 210Eh。)小甲鱼温馨提示：多种属性可以通过 “或运算” 使得同时拥有！</p>
<p>&nbsp;</p>
<p>The characteristics of the image. This member can be one or more of the following values.</p>
<p>&nbsp;</p>
<p><span style="font-family: 'Times New Roman';"> </span></p>
<p>&nbsp;</p>
<p><table></table></p>
<p><tbody></tbody></p>
<p><tr></tr></p>
<p><th>Value</th></p>
<p><th>Meaning</th><br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_RELOCS_STRIPPED   </span></dt></p>
<p><dt>0&#215;0001</dt><br><br></p>
<p><td><span style="font-size: xx-small;">Relocation information was stripped from the </span></td></p><p></p>
<p><span style="font-size: xx-small;">file. </span>The file must be loaded at its preferred</p>
<p>base address. If the base address is not</p>
<p>available, the loader reports an error.<br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_EXECUTABLE_IMAGE</span></dt></p>
<p><dt><span style="font-size: xx-small;">0&#215;0002</span></dt><br><br></p>
<p><td><span style="font-size: xx-small;">The file is executable (there are no unresolved </span></td></p>
<p><span style="font-size: xx-small;">external references).</span><br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_LINE_NUMS_STRIPPED</span></dt></p>
<p><dt><span style="font-size: xx-small;">0&#215;0004</span></dt><br><br></p>
<p><td><span style="font-size: xx-small;">COFF line numbers were stripped from the </span></td></p>
<p><span style="font-size: xx-small;">file.</span><br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_LOCAL_SYMS_STRIPPED</span></dt></p>
<p><dt><span style="font-size: xx-small;">0&#215;0008</span></dt><br><br></p>
<p><td><span style="font-size: xx-small;">COFF symbol table entries were stripped from </span></td></p>
<p><span style="font-size: xx-small;">file.</span><br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_AGGRESIVE_WS_TRIM</span></dt></p>
<p><dt><span style="font-size: xx-small;">0&#215;0010</span></dt><br><br></p>
<p><td><span style="font-size: xx-small;">Aggressively trim the working set. This value is </span></td></p>
<p><span style="font-size: xx-small;">obsolete </span>as of Windows 2000.<br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_LARGE_ADDRESS_AWARE</span></dt></p>
<p><dt><span style="font-size: xx-small;">0&#215;0020</span></dt><br><br></p>
<p><td><span style="font-size: xx-small;">The application can handle addresses larger </span></td></p>
<p><span style="font-size: xx-small;">than 2 GB.</span><br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_BYTES_REVERSED_LO</span></dt></p>
<p><dt><span style="font-size: xx-small;">0&#215;0080</span></dt><br><br></p>
<p><td><span style="font-size: xx-small;">The bytes of the word are reversed. This flag</span></td></p>
<p><span style="font-size: xx-small;"> is obsolete.</span><br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_32BIT_MACHINE</span></dt></p>
<p><dt><span style="font-size: xx-small;">0&#215;0100</span></dt><br><br></p>
<p><td><span style="font-size: xx-small;">The computer supports 32-bit words.</span></td><br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_DEBUG_STRIPPED</span></dt></p>
<p><dt><span style="font-size: xx-small;">0&#215;0200</span></dt><br><br></p>
<p><td><span style="font-size: xx-small;">Debugging information was removed and stored </span></td></p>
<p><span style="font-size: xx-small;">separately </span>in another file.<br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_REMOVABLE_RUN_FROM_SWAP</span></dt></p>
<p><dt><span style="font-size: xx-small;">0&#215;0400</span></dt><br><br></p>
<p><td><span style="font-size: xx-small;">If the image is on removable media, copy it to</span></td></p>
<p><span style="font-size: xx-small;">and run it </span>from the swap file.<br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_NET_RUN_FROM_SWAP</span></dt></p>
<p><dt><span style="font-size: xx-small;">0&#215;0800</span></dt><br><br></p>
<p><td><span style="font-size: xx-small;">If the image is on the network, copy it to and </span></td></p>
<p><span style="font-size: xx-small;">run it from </span>the swap file.<br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_SYSTEM</span></dt></p>
<p><dt><span style="font-size: xx-small;">0&#215;1000</span></dt><br><br></p>
<p><td><span style="font-size: xx-small;">The image is a system file.</span></td><br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_DLL</span></dt></p>
<p><dt><span style="font-size: xx-small;">0&#215;2000</span></dt><br><br></p>
<p><td><span style="font-size: xx-small;">The image is a DLL file. While it is an executable</span></td></p>
<p><span style="font-size: xx-small;"> file, </span>it cannot be run directly.<br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_UP_SYSTEM_ONLY</span></dt></p>
<p><dt><span style="font-size: xx-small;">0&#215;4000</span></dt><br><br></p>
<p><td><span style="font-size: xx-small;">The file should be run only on a uniprocessor</span></td></p>
<p><span style="font-size: xx-small;"> computer.</span><br></p>
<p><tr></tr></p>
<p><td></td></p>
<p><dl></dl></p>
<p><dt><span style="font-size: xx-small;">IMAGE_FILE_BYTES_REVERSED_HI</span></dt></p>
<p><dt><span style="font-size: xx-small;">0&#215;8000</span></dt><br><br></p>
<p><td><span style="font-size: xx-small;">The bytes of the word are reversed. This flag</span></td></p>
<p><span style="font-size: xx-small;"> is obsolete.</span><br><br><br></p>
<p></p><p>最后是自己写的读取dos头和pe头的代码（参考了醒哥的博客www.kkmonster.com）</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &amp;lt;stdio.h&amp;gt;</span></span><br><span class="line"><span class="comment">#include &amp;lt;windows.h&amp;gt;</span></span><br><span class="line"><span class="comment">#include &amp;lt;tchar.h&amp;gt;</span></span><br><span class="line"></span><br><span class="line">const TCHAR* FileName = <span class="string">"c:\windows\system32\cmd.exe"</span>;</span><br><span class="line"><span class="regexp">//</span>文件目录</span><br><span class="line">BYTE* pBase = NULL;</span><br><span class="line"><span class="regexp">//</span>基地址</span><br><span class="line">BYTE* fnReadFile();</span><br><span class="line"><span class="regexp">//</span>读取文件</span><br><span class="line"><span class="keyword">int</span> fnReadPE (BYTE *pBuffer);</span><br><span class="line"><span class="regexp">//</span>读取PE文件信息</span><br><span class="line">BYTE* fnReadDosHeader(BYTE* pBuffer);</span><br><span class="line"><span class="regexp">//</span>读取dos文件头信息</span><br><span class="line"><span class="keyword">int</span> fnReadNTHeader(BYTE* pBuffer);</span><br><span class="line"><span class="regexp">//</span>读取 PE文件头信息</span><br><span class="line"><span class="keyword">int</span> fnReadFileHeader(BYTE* ImageFileHeader);</span><br><span class="line"><span class="regexp">//</span>读取PE文件头中的FileHeader结构的信息</span><br><span class="line"><span class="keyword">int</span> fnReadOptionalHeader(BYTE* ImageOptionalHeader);</span><br><span class="line"><span class="regexp">//</span>读取PE文件头中的OptionalHeader结构的信息</span><br><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">BYTE* pBuffer = fnReadFile();</span><br><span class="line"></span><br><span class="line">fnReadPE (pBuffer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">BYTE* fnReadFile()</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"映射文件...n"</span>);</span><br><span class="line">HANDLE hFile = CreateFile(FileName, GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);</span><br><span class="line"><span class="regexp">//</span>读取文件</span><br><span class="line"><span class="keyword">if</span> (hFile == INVALID_HANDLE_VALUE)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"打开文件出错n"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">DWORD dwFileSize = GetFileSize(hFile, NULL);</span><br><span class="line"><span class="regexp">//</span>获得文件大小</span><br><span class="line">BYTE* pBuffer = new BYTE[dwFileSize];</span><br><span class="line"><span class="regexp">//new</span>相当于malloc</span><br><span class="line">DWORD dwSizeOfRead;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!ReadFile(hFile, pBuffer, dwFileSize, &amp;amp;dwSizeOfRead, NULL))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"读取文件出错n"</span>);</span><br><span class="line">pBase = NULL;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">pBase = pBuffer;</span><br><span class="line"><span class="keyword">return</span> pBase;</span><br><span class="line"><span class="regexp">//</span>基地址</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fnReadPE(BYTE *pBuffer)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"读取PE信息...n"</span>);</span><br><span class="line">BYTE* pBaseNTHeader = fnReadDosHeader(pBuffer);</span><br><span class="line"><span class="regexp">//</span>调用fnReadDosHeader函数获取Dos头信息,并且获得PE文件头的基地址</span><br><span class="line"><span class="keyword">if</span> (!pBaseNTHeader)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!fnReadNTHeader(pBaseNTHeader))</span><br><span class="line">//读取PE文件头信息</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">BYTE* fnReadDosHeader(BYTE* pBuffer)</span><br><span class="line">//读取dos文件头信息</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"读取DOS文件头...n"</span>);</span><br><span class="line">PIMAGE_DOS_HEADER SrcImageDosHeader = (PIMAGE_DOS_HEADER)pBuffer;</span><br><span class="line"><span class="keyword">if</span> (SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_magic != IMAGE_DOS_SIGNATURE)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"IMAGE_DOS_HEADER结构n"</span>);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_magic :<span class="variable">%04x</span> DOS可执行文件标记n"</span>,SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_magic);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_cblp :<span class="variable">%04x</span> Bytes on last page of filen"</span>,SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_cblp);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_cp :<span class="variable">%04x</span> Page in filen"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_cp);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_crlc :<span class="variable">%04x</span> Relocationsn"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_crlc);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_cparhdr :<span class="variable">%04x</span> Size of header in paragraphsn"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_cparhdr);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_minalloc:<span class="variable">%04x</span> Minimum extra paragraphs neededn"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_minalloc);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_maxalloc:<span class="variable">%04x</span> Maximum extra paragraphs neededn"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_maxalloc);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_ss :<span class="variable">%04x</span> Initial (relative) SS value DOS代码的初始化堆栈SSn"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_ss);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_sp :<span class="variable">%04x</span> Initial SP value DOS代码的初始化堆栈指针SPn"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_sp);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_csum :<span class="variable">%04x</span> Checksumn"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_csum);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_ip :<span class="variable">%04x</span> Initial IP value DOS代码的初始化指针入口n"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_ip);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_cs :<span class="variable">%04x</span> Initial (relative) CS value DOS代码的初始堆栈入口n"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_cs);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_lfarlc :<span class="variable">%04x</span> File address of elocation tablen"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_lfarlc);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_ovno :<span class="variable">%04x</span> Overlay numbern"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_ovno);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_res[4] :<span class="variable">%04x</span>, <span class="variable">%04x</span>, <span class="variable">%04x</span>, <span class="variable">%04x</span> Reserved wordsn"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_res[<span class="number">0</span>],SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_res[<span class="number">1</span>],SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_res[<span class="number">2</span>],SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_res[<span class="number">3</span>]);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_oemid :<span class="variable">%04x</span> OEM identifier (for e_oeminfo)n"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_oemid);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_oeminfo :<span class="variable">%04x</span> OEM information; e_oemid specificn"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_oeminfo);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_res2[10]:<span class="variable">%04x</span>,<span class="variable">%04x</span>,<span class="variable">%04x</span>,<span class="variable">%04x</span>,<span class="variable">%04x</span>,<span class="variable">%04x</span>,<span class="variable">%04x</span>,<span class="variable">%04x</span>,<span class="variable">%04x</span>,<span class="variable">%04x</span>, Reserved wordsn"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_res2[<span class="number">0</span>],SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_res2[<span class="number">1</span>],SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_res2[<span class="number">2</span>],SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_res2[<span class="number">3</span>],SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_res2[<span class="number">4</span>],SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_res2[<span class="number">5</span>],SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_res2[<span class="number">6</span>],SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_res2[<span class="number">7</span>],SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_res2[<span class="number">8</span>],SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_res2[<span class="number">9</span>]);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"e_lfanew :<span class="variable">%04x</span> File address of new exe header 指向PE文件头n"</span>, SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_lfanew);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> (BYTE*) (pBuffer + SrcImageDosHeader-&amp;<span class="keyword">gt</span>;e_lfanew);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fnReadNTHeader(BYTE* pBaseNTBuffer)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"读取PE文件头...n"</span>);</span><br><span class="line">PIMAGE_NT_HEADERS SrcImageNTHeader = (PIMAGE_NT_HEADERS)(pBaseNTBuffer);</span><br><span class="line"><span class="keyword">if</span> (SrcImageNTHeader-&amp;<span class="keyword">gt</span>;Signature != IMAGE_NT_SIGNATURE)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"IMAGE_NT_HEADERS结构n"</span>);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"Signature :<span class="variable">%08xn</span>"</span>, SrcImageNTHeader-&amp;<span class="keyword">gt</span>;Signature);</span><br><span class="line">fnReadFileHeader((BYTE*)&amp;amp;SrcImageNTHeader-&amp;<span class="keyword">gt</span>;FileHeader);</span><br><span class="line"><span class="regexp">//</span>读取FileHeader结构的信息</span><br><span class="line">fnReadOptionalHeader((BYTE*) &amp;amp;SrcImageNTHeader-&amp;<span class="keyword">gt</span>;OptionalHeader);</span><br><span class="line"><span class="regexp">//</span>读取OptionalHeader结构的信息</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fnReadFileHeader(BYTE* ImageFileHeader)</span><br><span class="line">&#123;</span><br><span class="line">PIMAGE_FILE_HEADER SrcImageFileHeader = (PIMAGE_FILE_HEADER)ImageFileHeader;</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"IMAGE_NT_HEADERS结构n"</span>);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"Machine: <span class="variable">%04xn</span>"</span>, SrcImageFileHeader-&amp;<span class="keyword">gt</span>;Machine);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"NumberOfSections: <span class="variable">%04xn</span>"</span>, SrcImageFileHeader-&amp;<span class="keyword">gt</span>;NumberOfSections);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"TimeDateStamp: <span class="variable">%08xn</span>"</span>, SrcImageFileHeader-&amp;<span class="keyword">gt</span>;TimeDateStamp);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"PointerToSymbolTable: <span class="variable">%08xn</span>"</span>, SrcImageFileHeader-&amp;<span class="keyword">gt</span>;PointerToSymbolTable);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"NumberOfSymbols: <span class="variable">%08xn</span>"</span>, SrcImageFileHeader-&amp;<span class="keyword">gt</span>;NumberOfSymbols);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"SizeOfOptionalHeader: <span class="variable">%04xn</span>"</span>, SrcImageFileHeader-&amp;<span class="keyword">gt</span>;SizeOfOptionalHeader);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"Characteristics: <span class="variable">%04xn</span>"</span>, SrcImageFileHeader-&amp;<span class="keyword">gt</span>;Characteristics);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> fnReadOptionalHeader(BYTE* ImageOptionalHeader)</span><br><span class="line">&#123;</span><br><span class="line">PIMAGE_OPTIONAL_HEADER SrcImageOptional_Header = (PIMAGE_OPTIONAL_HEADER)ImageOptionalHeader;</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"IMAGE_OPTIONAL_HEADER结构n"</span>);</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> Standard fields.</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"Magic: <span class="variable">%04xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;Magic);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"MajorLinkerVersion: <span class="variable">%02xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;MajorLinkerVersion);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"MinorLinkerVersion: <span class="variable">%02xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;MinorLinkerVersion);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"SizeOfCode: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;SizeOfCode);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"SizeOfInitializedData: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;SizeOfInitializedData);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"SizeOfUninitializedData: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;SizeOfUninitializedData);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"AddressOfEntryPoint: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;AddressOfEntryPoint);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"BaseOfCode: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;BaseOfCode);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"BaseOfData: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;BaseOfData);</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> NT additional fields.</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"ImageBase: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;ImageBase);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"SectionAlignment: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;SectionAlignment);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"FileAlignmen: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;FileAlignment);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"MajorOperatingSystemVersion:<span class="variable">%04xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;MajorOperatingSystemVersion);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"MinorOperatingSystemVersion:<span class="variable">%04xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;MinorOperatingSystemVersion);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"MajorImageVersion; <span class="variable">%04xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;MajorImageVersion);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"MinorImageVersion: <span class="variable">%04xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;MinorImageVersion);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"MajorSubsystemVersion: <span class="variable">%04xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;MajorSubsystemVersion);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"MinorSubsystemVersion: <span class="variable">%04xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;MinorSubsystemVersion);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"Win32VersionValue: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;Win32VersionValue);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"SizeOfImage: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;SizeOfImage);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"SizeOfHeaders: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;SizeOfHeaders);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"CheckSum: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;CheckSum);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"Subsystem: <span class="variable">%04xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;Subsystem);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"DllCharacteristics: <span class="variable">%04xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;DllCharacteristics);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"SizeOfStackReserve: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;SizeOfStackReserve);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"SizeOfStackCommit: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;SizeOfStackCommit);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"SizeOfHeapReserve: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;SizeOfHeapCommit);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"SizeOfHeapCommit: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;SizeOfHeapCommit);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"LoaderFlags: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;LoaderFlags);</span><br><span class="line"><span class="keyword">printf</span>(<span class="string">"NumberOfRvaAndSizes: <span class="variable">%08xn</span>"</span>, SrcImageOptional_Header-&amp;<span class="keyword">gt</span>;NumberOfRvaAndSizes);</span><br><span class="line"><span class="regexp">//</span>IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这只是初步，代码还有待完善。。。。</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2012/04/03/关于miibotree的由来/" itemprop="url">
                关于miibotree的由来
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2012-04-03T12:36:52+08:00" content="2012-04-03">
            2012-04-03
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>自从自己买了域名以后，一直有人说我的域名这么长，这么难记。</p>
<p>好吧，那我觉得自己还是有必要来解释下这个域名的意思。</p>
<p>首先，自己当初买域名的时候也是想了很多的。</p>
<p>我的域名是miibotree  可以分成两个部分来看</p>
<p>首先第一部分是mii   音译可以是me，也就是我的意思。为什么不是me而是mii。个人感觉mii更有一点文艺气息。   -_-|||</p>
<p>第二部分是botree   翻译出来是菩提树的意思。</p>
<p>大家都知道，菩提一词是佛教用语，是从印度传过啦的。下面这段是从网上摘下来的。</p>
<p>“菩提”一词是<a href="http://baike.baidu.com/view/118305.htm" target="_blank" rel="external">梵文</a>Bodhi的音译，意思是<a href="http://baike.baidu.com/view/526792.htm" target="_blank" rel="external">觉悟</a>、智慧，用以指人忽如睡醒，豁然开悟，突入彻悟途径，顿悟真理，达到超凡脱俗的境界等。</p>
<p>菩提是大彻大悟，明心见性，证得了最后的光明的自性，也就是达到了涅盘的程度。涅盘对凡夫来讲是人死了，实际上就是达到了无上菩提。 　　梵语bodhi，巴利语同。意译觉、智、知、道。广义而言，乃断绝世间烦恼而成就涅盘之智慧。即佛、<a href="http://baike.baidu.com/view/560244.htm" target="_blank" rel="external">缘觉</a>、声闻各于其果所得之觉智。此三种菩提中，以佛之菩提为无上究竟，故称<a href="http://baike.baidu.com/view/268843.htm" target="_blank" rel="external">阿耨多罗三藐三菩提</a>，译作无上正等正觉、无上正遍智、无上正真道、无上菩提。</p>
<p>还有一个原因，就是自己以前是师从方寸山菩提老祖的。斜月三星洞，灵台方寸山。</p>
<p>那么整个我的域名连起来，就是希望自己能够像菩提一样，大彻大悟。</p>
<p>再一个，就是miibotree读起来像是我们当地的方言 面包树。面包树又被称为是猴面包树。自己属猴。</p>
<p>&nbsp;</p>
<p>总之，不管别人怎么说，自己是很喜欢这个域名的。也希望大家能记住这个域名，希望大家没事就来我的网站踩踩支持我一下。呵呵，谢谢大家了。</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2012/04/01/CPU的大端与小端/" itemprop="url">
                CPU的大端与小端
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2012-04-01T20:51:25+08:00" content="2012-04-01">
            2012-04-01
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>Big-endian和little-endian(转载)</p>
<p>Big-endian和little-endian是描述排列存储在计算机内存里的字节序列的术语。</p>
<p>Big- endian是一种大值的一端（序列中更典型值）存在前面（在最小的存储地址）的顺序。Little-endian是一种小值的一端（序列中较不典型的 值）存储在前的顺序。比如，在Big-endian的电脑中，需要两个字节把十六位数4F52当作4F52存在存储器中（如果4F存在存储地址1000 中，比如说，52将存在1001中）。在little-endian系统里，将被存为524F（52存在存储地址1000中，比如说，4F将存在1001 中）。</p>
<p>IBM的370主机，多数基于RISC计算机，和Motorola的微处理器使用big-endian方法。TCP/IP也使用 big-endian方法（因此big-endian方法也叫做网络编码）。对于人来说我们的语言都是从左到右的习惯方式。这看上去似乎被认为是自然的存 储字符和数字方式-你同样也希望以同样的方式出现在你面前。我们总的许多人因此也会认为big-endian是流行的存储方式，正如我们平时所读到的。另 一个方面说，Intel处理器（CPUs）和DEC Alphas和至少一些在他们的平台的其他程序都是little-endian的。</p>
<p>有 个关于little-endian的争议是如果你增加数字的值，你可能在左边增加数字（高位非指数函数需要更多的数字）。因此，经常需要增加两位数字并移 动存储器里所有Big-endian顺序的数字，把所有数向右移。使用little-endian的存储器中不重要的字节可以存在它原来的位置，新的数可 以存在它的右边的高位地址里。这就意味着有些计算机的运作可以变得简单和快速。</p>
<p>语言编译器比如说Java或FORTRAN必须明确他们开发的目标代码使用的是什么存储方式。有必要的话可以使用转换器可以用来转换存储顺序。</p>
<p>注 意在使用big-endian和little-endian字节顺序中，一个位里面都是使用big-endian。也就是说，在存储的字节里一个位串代表 的给定数没有big-endian和little-endian之分。比如说，有个十六位数4F放在一个给定的字节地质前面或者后面，在这个字节的这一位 的里的顺序是:</p>
<p>01001111</p>
<p>从这一位的顺序来看有可能是big-endian也可能是little-endian，但是CPUs和程序几乎都是设计成big-endian位序的。尽管如此在数据的交换中它有可能其中的一种顺序。</p>
<p>Eric Raymond评述说Internet域名地址和e-mail地址是little-endian的。比如我们的网址用big-endian来表述是com.whatis.www。</p>
<p>Big- endian和little-endian来自于Jonathan Swift的Gulliver&#8217;s Travels ，Big-endian是那个大鸡蛋是打破大头的那个政治派别，而反对派Lilliputian King要求他的国民打鸡蛋的时候用小的那一头。</p>
<p>目 前的存储器，多以byte为访问的最小单元，当一个逻辑上的整理必须分割为物理上的若干单元时就存在了先放谁后放谁的问题，于是endian的问题应运而 生了。对于不同的存储方法，就有Big-endian和Little-endian两个描述。(这两个术语来自于 Jonathan Swift 的《《格利佛游记》其中交战的两个派别无法就应该从哪一端－－小端还是大端－－打开一个半熟的鸡蛋达成一致。在那个时代，Swift是在讽刺英国和法国之 间的持续冲突，Danny Cohen，一位网络协议的早期开创者，第一次使用这两个术语来指代字节顺序，后来这个术语被广泛接纳了。)</p>
<p>存 在“如果说&#8221;跟word或者说字长根本就没关系&#8221;，假设有一数据文件里面有N多数顺序排布，如果想以Little-Endian format 读入内存某区域，那么应该怎么读？怎么排？”这样的问题是由于对于endian的实质理解的偏差，endian指的是当物理上的最小单元比逻辑上的最小单 元小时，逻辑到物理的单元排布关系。这里的“有一数据文件里面有N多数顺序排布”，这个“有一数据”显然不是逻辑上的最小单元，而其中的“N多数”的一个 才是逻辑最小单元，于是可应用楼主表格中的原则排列，而“N多数”之间的顺序则是由这“N多数”的宿主决定的，比如是你写的程序，这个顺序由你决定。</p>
<p>刚才谈到了，endian指的是当物理上的最小单元比逻辑上的最小单元小时，逻辑到物理的单元排布关系。咱们接触到的物理单元最小都是byte，在通信领域中，这里往往是bit，不过原理也是类似的。</p>
<p>实践可以给你更多的经验，比如在一个嵌入式系统的通信协议中，从底层射频驱动到上层的协议栈全部需要实现，那么很可能遇到多个endian的问题，底层的bit序、协议层的byte序、应用层的byte序，这些都是不同的概念。</p>
<p>Big-Endian 和 Little-Endian 字节排序</p>
<p>字节排序                  含义</p>
<p>Big-Endian    一个Word中的高位的Byte放在内存中这个Word区域的低地址处。</p>
<p>Little-Endian  一个Word中的低位的Byte放在内存中这个Word区域的低地址处。</p>
<p>必须注意的是：表中一个Word的长度是16位，一个Byte的长度是8位。如果一个数超过一个Word的长度，必须先按Word分成若干部分，然后每一部分(即每个Word内部)按Big-Endian或者Little-Endian的不同操作来处理字节。</p>
<p>一个例子：</p>
<p>如果我们将0x1234abcd写入到以0&#215;0000开始的内存中，则结果为</p>
<p>big-endian   little-endian</p>
<p>0&#215;0000      0&#215;12        0xcd</p>
<p>0&#215;0001      0&#215;34        0xab</p>
<p>0&#215;0002      0xab        0&#215;34</p>
<p>0&#215;0003      0xcd        0&#215;12</p>
<p>除了moto的68K系列和dec的sparc是big endian外，常见的cpu都是little endian。ARM同时支持 big和little，实际应用中通常使用little endian。</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2012/03/31/开始学习汇编-PE/" itemprop="url">
                开始学习汇编+PE
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2012-03-31T16:48:28+08:00" content="2012-03-31">
            2012-03-31
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>非常感谢醒哥。让我有机会能跟着他参加信息安全的全国邀请赛。所以自己肯定是要好好学习汇编和PE了。</p>
<p>这里由于自己的电脑是64位的win7，无法使用debug，搜索了一把发现下面这个CSDN的网站提供了一个dos模拟器来运行32位的debug。</p>
<p>这里给出个链接</p>
<p><a href="http://blog.csdn.net/ropin_os/article/details/6578794" target="_blank" rel="external">http://blog.csdn.net/ropin_os/article/details/6578794</a></p>
<p>&nbsp;</p>
<p>接下来准备把自己电脑的win764位重装成win7 32位，顺便把opensuse给格了，最后等5月份的fedora17出来。</p>
<p>好了，废话不多说了，下面是自己学习汇编的一些笔记和问题。</p>
<p>一开始看PE文件格式，真的是看不懂，所以自己决定还是先看下汇编，然后再一边看PE可能会好点。</p>
<p>对于我这个连CPU跟内存都分不清楚的人。。。哎，首先还是先了解下CPU和内存吧。</p>
<p>CPU由下面这三个部分组成：运算器，控制器，寄存器</p>
<h3 id="运算器">运算器</h3><p>运算逻辑部件，可以执行定点或浮点的算术运算操作、移位操作以及逻辑操作，也可执行地址的运算和转换。</p>
<h3 id="寄存器">寄存器</h3><p>寄存器部件，包括通用寄存器、专用寄存器和控制寄存器。</p>
<div data-layout="right"><a href="http://baike.baidu.com/albums/14045/14045.html#0$6648d73d946dfdf89e3d6247" title="查看图片" target="_blank" rel="external">  </a><a href="http://baike.baidu.com/albums/14045/14045.html#0$6648d73d946dfdf89e3d6247" target="_blank" rel="external"><img src="http://imgsrc.baidu.com/baike/abpic/item/6648d73d946dfdf89e3d6247.jpg" alt="" title="32位CPU的寄存器"></a>32位CPU的寄存器</div>

<p>&nbsp;</p>
<p><strong>控制器</strong></p>
<p>控制部件，主要负责对指令译码，并且发出为完成每条指令所要执行的各个操作的控制信号。</p>
<p>与这三类对应的，分别有地址总线（对应运算器），数据总线（对应寄存器），控制总线（对应控制器）</p>
<p>地址总线：用来寻址。寻到内存的范围。</p>
<p>数据总线：进行数据的传送。自然是双向的。</p>
<p>控制总线：CPU对外部器件的控制</p>
<p>&nbsp;</p>
<p>接下来了解下内存：</p>
<p>存是计算机中重要的部件之一，它是与CPU进行沟通的桥梁。计算机中所有程序的运行都是在内存中进行的，因此内存的性能对计算机的影响非常大。 内存（Memory）也被称为内存储器，其作用是用于暂时存放CPU中的运算数据，以及与硬盘等外部存储器交换的数据。只要计算机在运行中，CPU就会把需要运算的数据调到内存中进行运算，当运算完成后CPU再将结果传送出来，内存的运行也决定了计算机的稳定运行。</p>
<p>简单的来说，其实内存就是计算机内部的一个高速的存储空间。</p>
<p>下面是自己摘的一些汇编的笔记。摘自王爽的《汇编语言》</p>
<p>1.关于段地址*16+偏移地址的形式</p>
<p>为什么我们要使用段地址*16+偏移地址的形式？为了增大cpu的寻址长度。</p>
<p>本质含义：cpu在访问内存时，用一个基础地址和一个相对基础地址的偏移地址相加，给出内存单元的物理地址</p>
<p>&nbsp;</p>
<p>2.CS代码 段寄存器  IP指令指针寄存器</p>
<p>使用CS：IP指向将要执行的指令在内存中的地址</p>
<p>偏移地址在什么时候自动增加？</p>
<p>当指令缓冲器读入一条指令后，IP自动增加读入指令的字节数。如果后面有（执行指令）修改IP的值，那么IP将会被覆盖掉。</p>
<p>&nbsp;</p>
<p>3.mov指令 传送指令</p>
<p>jmp指令  转移指令 可以修改 IP</p>
<p>格式  jmp  某一合法寄存器</p>
<p>作用  修改IP为寄存器中的值</p>
<p>4.关于debug的使用</p>
<p>R 查看，改变寄存器的内容</p>
<p>D查看内存中的内容</p>
<p>E改写内存中的内容</p>
<p>U将内存中的机器指令翻译成汇编指令</p>
<p>T执行一条机器指令</p>
<p>A以汇编的格式在内存中写入一条机器指令</p>
<p>具体方式这里就不讲解了。</p>
<p>5.内存中的数据和代码没有任何区别。</p>
<p>那么如何判断呢？</p>
<p>指令执行的一定是代码段！</p>
<p>下面是自己遇到的一些问题：</p>
<p>1.关于IP自动增加溢出的问题</p>
<p>上面讲了，经过指令缓冲器以后IP会自动增加，那么有没有IP溢出的状况呢？这个时候CPU是如何处理的呢？</p>
<p>这个问题暂时先放一下，希望看到后面的时候能解答这个问题。</p>
<p>2.关于debug里的u指令查看汇编代码的问题</p>
<p>首先用-e命令修改内存中的内容</p>
<p><a href="http://miibotree.com/wp-content/uploads/2012/03/1.jpg" target="_blank" rel="external"><img src="http://miibotree.com/wp-content/uploads/2012/03/1.jpg" alt="" title="1"></a></p>
<p>然后用-d查看一下</p>
<p><a href="http://miibotree.com/wp-content/uploads/2012/03/2.jpg" target="_blank" rel="external"><img src="http://miibotree.com/wp-content/uploads/2012/03/2.jpg" alt="" title="2"></a></p>
<p>再用-u查看一下</p>
<p><a href="http://miibotree.com/wp-content/uploads/2012/03/3.jpg" target="_blank" rel="external"><img src="http://miibotree.com/wp-content/uploads/2012/03/3.jpg" alt="" title="3"></a></p>
<p>原来1000 0  到1000 2存的是B8 23 01 对应的指令是mov ax,0123</p>
<p>这里自己产生了一个问题：如果-u的查看指针从1000:1开始呢？那么cpu默认的汇编代码是如何改变的呢？</p>
<p>下面这张截图就是从IP = 1开始的了。</p>
<p><a href="http://miibotree.com/wp-content/uploads/2012/03/4.jpg" target="_blank" rel="external"><img src="http://miibotree.com/wp-content/uploads/2012/03/4.jpg" alt="" title="4"></a></p>
<p>可以看到 cpu对于23 01 对应的汇编代码改变了，而下面的指令由于没有改变，任然和原来的是一样的</p>
<p>下面在更改一下，使得IP从2开始指向内存</p>
<p><a href="http://miibotree.com/wp-content/uploads/2012/03/6.jpg" target="_blank" rel="external"><img src="http://miibotree.com/wp-content/uploads/2012/03/6.jpg" alt="" title="6"> </a></p>
<p>这里也是差不多的，只是将01 b8 00 00 的汇编改成了add [bx+si+0000], di</p>
<p>自己还不知道这条指令是什么意思。</p>
<p>但这里可以发现一点，由于没有01 这条指令对应的汇编代码，所以cpu自动寻找下面的指令，直到能够翻译成一条汇编代码为止。</p>
<p>&nbsp;</p>
<p>不知道这样的推断是不是正确的，还请大家指教。。。。</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2012/03/30/2012年3月月末总结/" itemprop="url">
                2012年3月月末总结
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2012-03-30T15:10:53+08:00" content="2012-03-30">
            2012-03-30
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>这个月可以说是有点荒废掉了。。。</p>
<p>但是其实也不能这么说，自己是兴趣所好，做自己喜欢做的事情。</p>
<p>所以这个月一有空就去看梦的释义了。到目前为止自己已经看了大部分，在点点上记下了很多自己做的梦，又发表了一篇关于梦的释义的笔记，在记梦器的点点小站里面好像还挺火的，于是就激起了我看梦的释义的强烈兴趣。</p>
<p>不过话说回来，当初自己对心理学确实还是很感兴趣的，当初自己在挑专业的时候也想过要报考心理学专业，虽然没有实现，但是自己看看书还是挺有趣的。反正自己在看完梦的释义后是一定要写一篇比较长的笔记的。至于能写多长，那得看自己的水平了。反正自己的这个兴趣爱好绝对不是浪费时间，我暂时先把它归纳为探寻人生真理和生命真谛这类崇高的范围里面吧。</p>
<p>不过在六教自习的感觉还真的是很爽啊，想睡觉就睡觉，累了看看窗外的天空。。然后随时可以回到梦的世界里。。。。</p>
<p>还是回到自己的技术方面来，这个月自己可以用混乱来形容自己这个阶段的学习状况。一开始帮会计学院做网站，自己不感兴趣，于是就一直拖着，拖到现在还是没搞好。然后安卓也没怎么看了，有种半途而废的感觉。数据结构感觉看的也不是很多，才看到栈和队列那里。而且自己的博客这个月也没写多少。这样看来，自己这个月花在技术上的时间好像很少，倒是反而对学习感兴趣起来了。。。也不知道这是个好现象还是个不好的现象。。。。</p>
<p>在协会换位子了，做到了华哥旁边。</p>
<p>自己的fedora16不能上网了这个比较悲剧。坐等f17的出来。。。</p>
<p>玩了win8，一时兴起，现在好像也没多大兴趣了。。。</p>
<p>浙大的同学来下沙玩，跟高中同学一起聚一聚的感觉很好。</p>
<p>去参加了一个信息安全的讲座，又乘了回公交车。</p>
<p>这个月家园去了黄山旅游。。。很开心。景色很美。</p>
<p>学校的玉兰花开了，很美。</p>
<p>最后，这个月开始跟醒哥搞项目了。这个绝佳的学习机会自己不能浪费啊！！</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2012/03/17/顺序栈存储—-后缀表达式/" itemprop="url">
                顺序栈存储—-后缀表达式
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2012-03-17T20:25:12+08:00" content="2012-03-17">
            2012-03-17
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>中缀表达式</p>
<p>我们平时使用的表达式是中缀表达式，也就是说运算符都是在中间的，举个例子来说：</p>
<p>（56 &#8211; 20）/ （4 + 2）</p>
<p>中缀表达式是人们常用的算术表示方法。而且它是通过括号改变运算时候的优先级的。虽然我们看起来比较直观，但是对于机器来说，这样的表达式是很难运算的。</p>
<p>后缀表达式</p>
<p>所谓后缀表达式，就是将运算符放在操作数的后面，比如1+2_3的后缀表达式为123_+。（这里为了区分操作数，我们用#号表示操作数的结束,也就是1#23#*+）</p>
<p>在后缀表达式中，已经考虑了运算符的优先级（通过顺序已经表现出来了），而且没有括号，只有操作数和运算符。所以对机器来说就容易运算了。</p>
<p>从中缀表达式变成后缀表达式，我们可以使用栈的方式来完成。</p>
<p>算法描述：</p>
<p>将中缀表达式转换为等价的后缀表达式的过程要使用一个栈放“（”，具体可以按照下面的方式进行。</p>
<p>（1）从左到右依次扫描中缀表达式的每一个字符，如果是数字字符和圆点“.”则直接将它们写入后缀表达式中。</p>
<p>（2）如果遇到的是开括号“（”，则将它们压入一个操作符栈（不需要与栈顶操作符相比较），它表明一个新的计算层次的开始，在遇到和它匹配的闭括号“）”时，将栈中的元素弹出来并放入后缀表达式中，直到栈顶元素为“(”时，将栈顶元素“（”弹出（不需要加入后缀表达式），表明这一层括号内的操作处理完毕。</p>
<p>（3）如果遇到的是操作符，则将该操作符和操作符栈顶元素比较：</p>
<p>1、当所遇到的操作符的优先级小于或等于栈顶元素的优先级时，则取 出栈顶元素放入后缀表达式，并弹出该栈顶元素，反复执行直到当前操作符的优先级大于栈顶元素的优先级小于；</p>
<p>2、当所遇到的操作符的优先级大于栈顶元素的优先级的时则将它压入栈中。</p>
<p>（4）重复上述步骤直到遇到中缀表达式的结束符标记“#”，弹出栈中的所有元素并放入后缀表达式中，转换结束</p>
<p>可能这样不是很清楚，自己在百度百科里面找到下面的方法描述看起来比较清楚一点：</p>
<p>人工实现转换</p>
<p>这里我给出一个中缀表达式：a+b*c-(d+e)</p>
<p>第一步：按照运算符的优先级对所有的运算单位加括号：式子变成了：((a+(b*c))-(d+e))</p>
<p>第二步：转换前缀与后缀表达式</p>
<p>前缀：把运算符号移动到对应的括号前面</p>
<p>则变成了：-( +(a *(bc)) +(de))</p>
<p>把括号去掉：-+a*bc+de 前缀式子出现</p>
<p>后缀：把运算符号移动到对应的括号后面</p>
<p>则变成了：((a(bc)* )+ (de)+ )-</p>
<p>把括号去掉：abc*+de+- 后缀式子出现</p>
<p>发现没有，前缀式，后缀式是不需要用括号来进行优先级的确定的。如表达式：3+(2-5)*6/3</p>
<p>下面是自己用c语言写的栈的数据结构完成从中缀表达式到后缀表达式的转换以及求值的运算：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#include &amp;amp;lt;stdio.h&amp;amp;gt;</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> MaxSize 100</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> ElemType char</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></span><br><span class="line">&#123;</span><br><span class="line">ElemType data[MaxSize];</span><br><span class="line"><span class="keyword">int</span> top;</span><br><span class="line">&#125;SqStack;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">trans</span><span class="params">(<span class="keyword">char</span> *<span class="built_in">exp</span>, <span class="keyword">char</span> postexp[])</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">float</span> <span class="title">compvalue</span><span class="params">(<span class="keyword">char</span> *postexp)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span><br><span class="line"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> <span class="built_in">exp</span>[MaxSize];</span><br><span class="line"><span class="keyword">char</span> postexp[MaxSize], final[MaxSize];</span><br><span class="line"><span class="built_in">printf</span>(&amp;quot;请输入中缀表达式n&amp;quot;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(&amp;quot;%s&amp;quot;, <span class="built_in">exp</span>);</span><br><span class="line"></span><br><span class="line">trans(<span class="built_in">exp</span>, postexp);<span class="comment">//exp存放中缀表达式,postexp存放后缀表达式</span></span><br><span class="line"><span class="built_in">printf</span>( &amp;quot;后缀表达式的值n&amp;quot;);</span><br><span class="line"><span class="built_in">printf</span>(&amp;quot;%.<span class="number">2f</span>n&amp;quot;, compvalue(postexp));</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">trans</span><span class="params">(<span class="keyword">char</span> *<span class="built_in">exp</span>, <span class="keyword">char</span> postexp[])</span></span><br><span class="line"></span>&#123;</span><br><span class="line">SqStack op;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">op.top = -<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (*<span class="built_in">exp</span> != &amp;<span class="preprocessor">#039; &amp;#039;)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">switch</span> (*<span class="built_in">exp</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> &amp;<span class="preprocessor">#039;(&amp;#039;:<span class="comment">//左括号进栈</span></span></span><br><span class="line">op.top++;</span><br><span class="line">op.data[op.top] = *<span class="built_in">exp</span>;</span><br><span class="line"><span class="built_in">exp</span>++;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> &amp;<span class="preprocessor">#039;)&amp;#039;:<span class="comment">//将op栈中&amp;ldquo;（&amp;rdquo;以前的运算符依次删除存入数组exp中，然后将&amp;ldquo;（&amp;rdquo;删除</span></span></span><br><span class="line"><span class="keyword">while</span> (op.data[op.top] != &amp;<span class="preprocessor">#039;(&amp;#039;)</span></span><br><span class="line">&#123;</span><br><span class="line">postexp[i++] = op.data[op.top];</span><br><span class="line">op.top--;</span><br><span class="line">&#125;</span><br><span class="line">op.top--;<span class="comment">//&amp;quot;(&amp;quot;退栈</span></span><br><span class="line"><span class="built_in">exp</span>++;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> &amp;<span class="preprocessor">#039;+&amp;#039;:</span></span><br><span class="line"><span class="keyword">case</span> &amp;<span class="preprocessor">#039;-&amp;#039;:</span></span><br><span class="line"><span class="keyword">while</span> (op.top != -<span class="number">1</span> &amp;amp;amp;&amp;amp;amp; op.data[op.top] != &amp;<span class="preprocessor">#039;(&amp;#039;)</span></span><br><span class="line">&#123;<span class="comment">//将栈中&amp;quot;（&amp;quot;前面的运算符退栈并存放到postexp中</span></span><br><span class="line">postexp[i++] = op.data[op.top];</span><br><span class="line">op.top--;</span><br><span class="line">&#125;</span><br><span class="line">op.top++;</span><br><span class="line">op.data[op.top] = *<span class="built_in">exp</span>;</span><br><span class="line"><span class="built_in">exp</span>++;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> &amp;<span class="preprocessor">#039;*&amp;#039;:</span></span><br><span class="line"><span class="keyword">case</span> &amp;<span class="preprocessor">#039;/&amp;#039;:</span></span><br><span class="line"><span class="keyword">while</span> (op.data[op.top] == &amp;<span class="preprocessor">#039;*&amp;#039; || op.data[op.top] == &amp;#039;/&amp;#039;)</span></span><br><span class="line">&#123;<span class="comment">//将栈中的&amp;ldquo;*&amp;rdquo;或者是&amp;ldquo;/&amp;rdquo;运算符依次出栈并存放到postexp中</span></span><br><span class="line">postexp[i++] = op.data[op.top];</span><br><span class="line">op.top--;</span><br><span class="line">&#125;</span><br><span class="line">op.top++;</span><br><span class="line">op.data[op.top] = *<span class="built_in">exp</span>;</span><br><span class="line"><span class="built_in">exp</span>++;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> &amp;<span class="preprocessor">#039; &amp;#039;:break;</span></span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">while</span> (*<span class="built_in">exp</span> &amp;amp;gt;= &amp;<span class="preprocessor">#039;0&amp;#039; &amp;amp;amp;&amp;amp;amp; *exp &amp;amp;lt;= &amp;#039;9&amp;#039;)</span></span><br><span class="line">&#123;</span><br><span class="line">postexp[i++] = *<span class="built_in">exp</span>;</span><br><span class="line"><span class="built_in">exp</span>++;</span><br><span class="line">&#125;</span><br><span class="line">postexp[i++] = &amp;<span class="preprocessor">#039;#&amp;#039;;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (op.top != -<span class="number">1</span>)<span class="comment">//最后的扫描工作</span></span><br><span class="line">&#123;</span><br><span class="line">postexp[i++] = op.data[op.top];</span><br><span class="line">op.top--;</span><br><span class="line">&#125;</span><br><span class="line">postexp[i] = &amp;<span class="preprocessor">#039; &amp;#039;;</span></span><br><span class="line"><span class="built_in">printf</span>(&amp;quot;后缀表达式n&amp;quot;);</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &amp;amp;lt; i; j++)</span><br><span class="line"><span class="built_in">printf</span>(&amp;quot;%c&amp;quot;, postexp[j]);</span><br><span class="line"><span class="built_in">printf</span>(&amp;quot;n&amp;quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">float</span> <span class="title">compvalue</span><span class="params">(<span class="keyword">char</span> *postexp)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">SqStack st;</span><br><span class="line"><span class="keyword">float</span> a, b, c, d;</span><br><span class="line">st.top = -<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(*postexp != &amp;<span class="preprocessor">#039; &amp;#039;)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">switch</span>(*postexp)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> &amp;<span class="preprocessor">#039;+&amp;#039;:</span></span><br><span class="line">a = st.data[st.top];</span><br><span class="line">st.top--;</span><br><span class="line">b = st.data[st.top];</span><br><span class="line">st.top--;</span><br><span class="line">c = a + b;</span><br><span class="line">st.top++;</span><br><span class="line">st.data[st.top] = c;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> &amp;<span class="preprocessor">#039;-&amp;#039;:</span></span><br><span class="line">a = st.data[st.top];</span><br><span class="line">st.top--;</span><br><span class="line">b = st.data[st.top];</span><br><span class="line">st.top--;</span><br><span class="line">c = b - a;</span><br><span class="line">st.top++;</span><br><span class="line">st.data[st.top] = c;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> &amp;<span class="preprocessor">#039;*&amp;#039;:</span></span><br><span class="line">a = st.data[st.top];</span><br><span class="line">st.top--;</span><br><span class="line">b = st.data[st.top];</span><br><span class="line">st.top--;</span><br><span class="line">c = a * b;</span><br><span class="line">st.top++;</span><br><span class="line">st.data[st.top] = c;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> &amp;<span class="preprocessor">#039;/&amp;#039;:</span></span><br><span class="line">a = st.data[st.top];</span><br><span class="line">st.top--;</span><br><span class="line">b = st.data[st.top];</span><br><span class="line">st.top--;</span><br><span class="line"><span class="keyword">if</span> (a != <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">c = b / a;</span><br><span class="line">st.top++;</span><br><span class="line">st.data[st.top] = c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(&amp;quot;nt除零错误!n&amp;quot;);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:<span class="comment">//进行最后的扫尾工作，将数字字符转换成数值存放到d中</span></span><br><span class="line">d = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (*postexp &amp;amp;gt;= &amp;<span class="preprocessor">#039;0&amp;#039; &amp;amp;amp;&amp;amp;amp; *postexp &amp;amp;lt;=&amp;#039;9&amp;#039;)</span></span><br><span class="line">&#123;</span><br><span class="line">d = <span class="number">10</span> * d + *postexp - &amp;<span class="preprocessor">#039;0&amp;#039;;</span></span><br><span class="line">postexp++;</span><br><span class="line">&#125;</span><br><span class="line">st.top++;</span><br><span class="line">st.data[st.top] = d;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">postexp++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> (st.data[st.top]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>还是举个例子来说明上面这段程序：</p>
<p>我输入的中缀表达式是：  (56-20)/(4+2)</p>
<p>op栈（临时存放）       postexp（后缀表达式）           exp                                            说明</p>
<p>(                                                                                           (56-20)/(4+2)                       遇到字符&#8221;（&#8221;，进栈op</p>
<p>(                                      5                                                     56-20)/(4+2)                      遇到数字“5”，进postexp</p>
<p>(                                      56                                                     6-20)/(4+2)                      遇到数字“6”，进postexp</p>
<p>(-                                     56#                                                     -20)/(4+2)                      遇到“-”，先在postexp上加入#表示数字结束，然后将“-”压入op栈中</p>
<p>(-                                     56#20#                                               20)/(4+2)                       同上，遇到了连续遇到数字，将“20”写入postexp中，然后加上“#”表示数字结束</p>
<p>56#20# -                                                  )/(4+2)                        遇到了&#8221;）&#8221;，将op栈中“（”以前的字符     这里是“-”   压入postexp中，然后将“（”清除</p>
<p>/                                      56#20# -                                                   /(4+2)                        遇到“/”，放如op栈中</p>
<p>/(                                     56#20# -                                                    (4+2)                       遇到了“（”，将括号压入op栈中</p>
<p>/(                                     56#20# -4                                                   4+2)                        遇到了数字“4”，直接压入postexp中</p>
<p>/(+                                   56#20# -4#                                                   +2)                         遇到了“+”，先在postexp中加入“#”表示数字结束，然后在op栈中压入“+”</p>
<p>/(+                                   56#20# -4#2                                                   2)                       遇到了数字“2”，直接压入postexp中</p>
<p>/                                       56#20# -4#2#+                                                )                       遇到了“)”，先在postexp中加入“#表示数字结束，再在op栈中压入“(”以前的字符 这里是“+”</p>
<p>56#20# -4#2#+                                                                          扫描完毕，将op栈中的字符压入postexp中</p>
<p>吼吼～～～，终于完成了，下面我们来看下规律</p>
<p>1.遇到数字，直接压入postexp栈中，知道出现的字符不是数字，则加“#”表示结束</p>
<p>2.遇到&#8221;+&#8221;   &#8220;-&#8221;    &#8220;*&#8221;      &#8220;/&#8221;   操作符，直接压入op栈中临时存放</p>
<p>3.遇到“ (”,   直接压入op栈中</p>
<p>4.遇到&#8221;)&#8221;,将op栈中“(”以前的所有字符全部压入postexp栈中，然后将op栈中的&#8221;(&#8220;销毁     （   注意这里的“(”是与“)”对应的前一个&#8221;(&#8221;      ）</p>
<p>至于后缀表达式的求值，相信看了中缀表达式怎么转变成后缀表达式了以后理解求值就不是很难了吧。。。</p>
<p>最后还是说一句：自己是新手，有什么错误恳请大家指教。谢谢&#8230;&#8230;&#8230;&#8230;</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2012/03/17/写给想当程序员的朋友/" itemprop="url">
                写给想当程序员的朋友
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2012-03-17T13:34:50+08:00" content="2012-03-17">
            2012-03-17
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>自己最近想考程序员。心想考了程序员那自己不是真的成了一个程序猿了吗？</p>
<p>然后就找到了下面这篇文章：</p>
<p>谨以此文献给所有想当程序员的朋友</p>
<p>（一） 文章由来及个人经历</p>
<p>我是一名计算机专业的本科毕业生，毕业已经1年多了。毕业后从事的是软件编程工作，经常有其他专业的朋友想从事软件编程工作，向我请教如何，因为我自觉涉行不深，不敢信口开河，无奈朋友信任，我不得不郑重考虑一下这个问题了，来帮助朋友选择和回报朋友的信任。</p>
<p>这也就是此文的由来。</p>
<p>还是先谈谈我个人的经历吧。（是不是有点俗套，但我觉得了解我的经历，有助于理解我话的含义；我一向认为不了解古龙的生活经历的，不会真正读懂古 龙的作品和古龙笔下的英雄的）我本科就读于南方一所著名的高校（因为自己的不成气，愧谈母校名谓），学的就是计算机专业。上本科时，几乎没有认真的听完一 门专业课程，上课看报纸睡大觉，下课看录像看小说看球赛，临考抱佛脚，每次考试和课程设计都是蒙混过关。（于之相对是，我选修的工商管理和经济贸易方面的 课到是听得不亦乐乎，考的分数颇高，也许这才是我的真正兴趣所在。）</p>
<p>总而言之，大学是混过来了，对专业的理解和掌握程度，应该没有达到毕业要求的合格水平。（也很后悔，但是有什么用呢，当时不知道珍惜；如果上天再 给我一次机会的话，我一定会抓住，多看点美国大片少看点港片；现在，重回校园是我的一大理想）但是大学的学习使我有了一个简单的知识框架（总算学费没白 交），我对一个朋友这样形容过我的这个知识框架，“它不是钢筋铸的，是稻草扎的”，哈哈哈，不要笑，真的，我敢说很多本科毕业的朋友的本专业的知识框架也只不过是“稻草扎的”。直到现在，我一直觉得自己的基础知识还是很薄弱，一直想抓点时间，把基础书本好好的温习一下。（此项任务正在计划和实施中）</p>
<p>毕业后，分配到某研究所工作。当领导让我选择自己以后的工作方向时，我毫不犹豫的选择了软件（也不知道到底是对还是错，但我决不后悔）。此研究所 主要是以硬件为核心搞通信控制设备的研发生产；软件是辅助，所以也不受什么重视，很多搞软件的人都跳槽走了，留下来的大都是一些已经废掉和行将废掉的“伪/萎”程序员（名副其实的“软件人员”）。 在这里感觉不到什么高紧张和高技术程度的研究和开发；软件开发的技术含量极低，以致于大部分人只有半年的学习和开发经验，以后都是这些知识和经验的重复利 用。（我问过其他到研究所工作的同学，他们说都一样，呜呼，我们的国防科研开发呀）对于软件的开发，领导的意志和老掉牙的经验在新课题的技术采用和开发中 起了决定性作用，没有明确的需求，没有明确的开发计划和进度，大家在一天一天一周一周的浪费着宝贵的时间，最后开发出来的东西修来改去，直至它变成垃 圾。 我越来越认识到一点，要么象那些废人一样废掉，要么自己去努力寻求出路，反正别指望从工作中得到什么高明的经验了（教训倒也许有）。期间发生了一些 感情上的纠纷，严重的影响了学习计划和效果，直到现在浮躁的心仍然有些浮躁。</p>
<p>期间，我读了一些书，看了一些文章，编过一些小例程，搞了一些没有什么技术含量的开发工作，也和一些前辈和高手们谈过聊过。 我一直在思考几个问 题；如何学习软件开发？如何搞软件开发，国外的软件开发到底其秘诀在何处？为何我们的软件业一直在低水平徘徊？我们难道真的离了Microsoft就活不了？我们的程序员到底在浪费时间干些什么？软件开发到底是如何分类的？我们如何走自己的民族软件之路？</p>
<p>我想了很久，一些想通了，一些还在想。但我知道有一点是肯定的，那就是我们一定要靠我们自己走出自己的软件之路！跟在别人屁股后面永远受制于人！</p>
<p>好了，关于经历和牢骚就先写这些吧，该进入我们的正题了。</p>
<p>（二） 你适合当程序员吗，你知道编程序是怎么回事吗？</p>
<p>1、 程序员意味着要编程序。（如果你仅仅想得到一份高薪水的工作，喝喝咖啡就等老板发薪水，我奉劝你还是另找一份更合适的工作，譬如练摊，真的，兄弟，这份工作不适合你）</p>
<p>2、你是学文的还是学理的，编程序也许需要浪漫，但更需要逻辑和严谨。（说坦白点就是，在你没有找到乐趣以前，它很枯燥）</p>
<p>3、你有对新技术追求的热情吗？你有刨根问底的探索精神吗？（热情绝对是最重要的！你仔细思考一下自己的性格适合当程序员吗？）</p>
<p>4、当程序员决不是什么好差事，时刻需要学习，需要思考。（直到你成为那个可以引导别人去学习和思考的人，你才可以偷偷的嘿嘿笑，又一群傻蛋）</p>
<p>5、程序员的未来很迷茫。（但我认为关键看你自己！我希望你是一个有追求的人，不仅仅是混碗饭吃。因为真正的乐趣在于创造；如果你能改变软件业的历史，那才是英雄；不想成为Bill Gates，不想成为Dennis Ritchie和 Bjarne Stroustrup，我会说你没有追求。有个关于程序员未来的笑话，也许你还没听过，你该听一听，摘抄如下：</p>
<p>一个程序员对自己的未来很迷茫，于是去问上帝。</p>
<p>“万能的上帝呀，请你告诉我，我的未来会怎样？”</p>
<p>上帝说“我的孩子，你去问Lippman，他现在领导的程序员的队伍可能是地球上最大的”</p>
<p>于是他去问Lippman。</p>
<p>Lippman说“程序员的未来就是驾驭程序员”</p>
<p>这个程序员对这个未来不满意，于是他又去问上帝。</p>
<p>“万能的上帝呀，请你告诉我，我的未来会怎样？”</p>
<p>上帝说“我的孩子，你去问Gates，他现在所拥有的财产可能是地球上最多的”</p>
<p>于是他去问Gates。</p>
<p>Gates说“程序员的未来就是榨取程序员”</p>
<p>这个程序员对这个未来不满意，于是他又去问上帝。</p>
<p>“万能的上帝呀，请你告诉我，我的未来会怎样？”</p>
<p>上帝说“我的孩子，你去问侯捷，他写的计算机书的读者可能是地球上最多的”</p>
<p>于是他去问侯捷。</p>
<p>侯捷说“程序员的未来就是诱惑程序员”</p>
<p>这个程序员对这个未来不满意，于是他又去问上帝。</p>
<p>“万能的上帝呀，请你告诉我，我的未来会怎样？”</p>
<p>上帝摇摇头“唉，我的孩子，你还是别当程序员了”）</p>
<p>6、当程序员还是很有乐趣的。（当你学到新知识时，当你有新的思想见解时，当你有新的产品问世时，和知己探讨你的成果时…我问你，觉得这些是乐趣吗？）</p>
<p>7、当程序员不易也不难。（世间事有难易乎？为之…；不为…。你有决心和信心吗？）</p>
<p>8、你真的要当程序员？是你自己的想法？</p>
<p>9、 你舍得花钱买书吗？（读好书绝对是学习编程的最佳捷径。你一定会说，现在电脑书籍真他妈的贵，没法子，谁让知识和技术在人家的脑袋，在人家的书里呢；等你 写书时可以把价格定低一点，记着还有好多没钱但想买书的兄弟很困难呀。要舍得买书，买好书，不好的的书不如不读，其害大于其益，关于买什么书，你可以问高 手或看候捷的书评；准备一个小本子记录你想买的书的名字，逛书店时看看，如果好就买下，记住要读，别光买不看。）</p>
<p>10、我告诉你，程序就是：任何有目的的、预想好的动作序列，它是一种软件。</p>
<p>11、编程序就是编写程序。</p>
<p>12、你想好了吗？（如果你想好了还是决定要当程序员，可以继续往下读；否则，你可以继续寻找别的出路了。）</p>
<p>（三） 一个程序员应该具备的基础知识和概念</p>
<p>1、计算机是有什么组成的，CPU是什么东西，其工作原理是什么。（对于这些以及下面将要提到的概念我不会告诉你什么答案，你可以看相应的教材，关于教材我会在下一部分详述，记住理解最重要！）</p>
<p>2、机器语言和微指令集的概念。</p>
<p>3、程序的概念。</p>
<p>4、汇编语言是低级语言但不是机器语言。</p>
<p>5、高级语言主要有那些？（C，C＋＋，Basic，Pascal，Fortran，C#，Java等等；如果你是中国软件业的英雄，你也写一门语言，最好不用英语） 6、编译程序和解释程序的概念和其原理。（编译器是高手和专家编写的）</p>
<p>7、HTML、XML等是标识性语言。</p>
<p>8、Prolog是人工智能语言。</p>
<p>9、操作系统OS的概念和原理。（Windows98，Windows2000，Windows NT，UNIX，Linux，等等都是OS，还有一些实时OS，嵌入OS，编这些的绝对是高手）</p>
<p>10、Windows编程说白了就是Windows API的调用。（中国的程序员很多只是会编windows程序，用的是VB，我的建议是这些程序员顶多只是低级编码员，我称其是coder）</p>
<p>11、VC＋＋、VB、BC、BCB、Delphi、VF等都只是编程的工具和环境，不是编程语言。</p>
<p>12、面向结构的设计概念。</p>
<p>13、面向对象的概念。（好好理解，兄弟，这个东西还是很重要的）</p>
<p>14、软件工程的概念和原理。（如果你想当老总就需要好好研究了，系统分析员比编码员要高一个等级，薪水也高哟） 15、数据库的概念。（要熟悉一些著名的数据库系统和语言的名字，如Orcle，SQL，DB2，DyBase等）</p>
<p>16、了解网络概念。</p>
<p>17、了解多媒体概念。</p>
<p>18、熟悉和掌握数据结构和基本算法。</p>
<p>19、 是不是要求太高了，别着急慢慢来，进步在不知不觉之中。（一旦开始学习，一个月以后你就会有一个基本的概念；两个月以后你就会感觉自己有了全面的基础知 识；当你知道编程序是怎么回事时，说明你已经入门了。也有很多人编了很多年程序还没有入门呢，你不会希望自己步其后尘吧。要有信心和耐心。沉不住气怎么能 成大事？！）</p>
<p>（四） 教材推荐</p>
<p>推荐的教材主要还是针对概念来的，最好选用名校的教学用书。</p>
<p>1、《计算机组成原理》（熟悉）</p>
<p>2、《数据结构》（掌握）</p>
<p>3、《操作系统》（了解-&gt;熟悉）</p>
<p>4、《The C language》（掌握）</p>
<p>5、《编译原理》（了解原理）</p>
<p>6、《汇编语言》（了解）</p>
<p>7、《计算机网络》（了解）</p>
<p>8、《软件工程》（了解）</p>
<p>9、《关系数据库》（熟悉）</p>
<p>10、《The C＋＋Languege 》（掌握）</p>
<p>11、《面向对象设计》（掌握；结合C++学习）</p>
<p>（五）一些经验和体会</p>
<p>1、真正的程序员用C++；（一位专家说的）</p>
<p>2、动手去编程序；</p>
<p>3、动脑去思考；</p>
<p>4、要有良好的编程风格；</p>
<p>5、读书，读好书，尽量读原版书！（我反复强调这一点，读书要有选择，坚持读好书，名家出的经典书，不要浪费实践在一些粗制滥造的书上面；坚持博览群书）</p>
<p>6、有自己的学习计划；</p>
<p>7、总结自己的经验教训；（准备一个笔记本，记录错误和心得）</p>
<p>8、不要怕学新东西；</p>
<p>9、要有软件工程的思想；</p>
<p>10、善于发现问题，然后去寻找答案；</p>
<p>11、向高手请教；（要虚心直到你成为高手）</p>
<p>12、和同行交流；（不善于交流肯定不行）</p>
<p>13、懂得软件的实质，不要被千变万化的表象所迷惑；</p>
<p>14、真正要学习用的是编程语言和方法，不是什么库，什么类，什么工具；（学用那些什么库都比较简单，但光会这些库，我觉得还远远不够）</p>
<p>15、学习wiodows编程主要是学习windows OS和win32 API；</p>
<p>16、有空了解一下嵌入式开发；</p>
<p>17、有空了解一下PDA软件开发；</p>
<p>18、了解一下.NET框架和C#语言，也许它是你新的衣食父母；</p>
<p>19、要有耐心，不要作浮躁的人；</p>
<p>20、对程序加注释，并保留你的老程序；</p>
<p>21、学到的东西越多，了解的越多，你就越接近专家；</p>
<p>22、有空去逛逛CSDN，那里有你很多知己；</p>
<p>23、要有信心成为一个优秀的程序；</p>
<p>（六）一些好书的推荐</p>
<p>1、《The C Programming language》 （Keinighan &amp; Dennis Ritchie 1988）</p>
<p>2、《The C++ Programming Languague》（Bjarne Stroustrup 1997）</p>
<p>3、《Inside The C++ Object Model》 （lippmans）</p>
<p>4、《Effective C++》 （同上）</p>
<p>5、《More Effective C++》 （同上）</p>
<p>6、《Exceptional c++》</p>
<p>7、《C++面向对象高效编程》</p>
<p>8、《设计模式》</p>
<p>9、《Thinking In C++》</p>
<p>10、《The Standard C++ Bible》（一般推荐）</p>
<p>11、《The Art of Computer Programming 》</p>
<p>12、《Programming Windows》 （Charles Petzold）</p>
<p>13、《VC++5.0技术内幕》</p>
<p>14、《MFC 深入浅出》</p>
<p>15、《软件需求》</p>
<p>16、《Advanced Windows》</p>
<p>17、《C++ primer》</p>
<p>18、《win32程序员参考手册》</p>
<p>19、《用TCP/IP进行网际互连》</p>
<p>20、《COM 本质论》</p>
<p>（七）学习计划</p>
<p>这个学习计划是我个人定的，也共享给大家参考一下，共同进步吧。 1、《计算机组成原理》</p>
<p>2、《操作系统》</p>
<p>3、《数据结构》</p>
<p>4、《汇编语言》</p>
<p>5、《 C 》</p>
<p>6、《 C++ 》</p>
<p>7、《VC 技术内幕》</p>
<p>8、《Programming Windows》</p>
<p>9、《深入浅出MFC》</p>
<p>10、《Advanced Windows》</p>
<p>11、《Inside The C++ Object Model》</p>
<p>12、《Thinking in C++》</p>
<p>13、《Effective C++》</p>
<p>14、数据库</p>
<p>15、网络</p>
<p>16、嵌入式OS和编程</p>
<p>17、硬件单片机</p>
<p>18、.NET和C#</p>
<p>19、软件工程</p>
<p>20、UNIX和Linux</p>
<p>（八）后记</p>
<p>一年来浪费了大量的时间去摸索，去思考，走了很多的弯路，直到现在我还觉得自己是个编程的门外汉。我把我的一些体会和想法说出来（当然，很多都不 一定正确，欢迎大家指正和讨论），也许对一些想加入程序员行列的朋友有一些建议和帮助。希望能帮助这些朋友顺利走上编程之路，成为高手。</p>
<p>如果真能如此，我也就很高兴了。欢迎有兴趣的朋友给我发E_mail（sjpsky@163.net）；我这个人有两大业余爱好，其一就是读武侠小说，其二就是结交英雄侠士。</p>
<p>我要说明的就是我的这篇小文，主要是想给“一些想成为程序员”的朋友一些建议，帮他们寻找一条自我培训的捷径，（其实世界上没有什么捷径的，我觉得一切都在于悟性，师傅领进门，修行在个人，譬如我就修行不够）少象我一样作大量的无用功。还有，主要就是一个程序员应该具备的基本功（个人看法）,有人称其为“内功”，我觉得很对。没有扎实的基本功，我们如何能够做到游刃有余的编写高质量高性能的优秀程序呢？</p>
<p>读后感：</p>
<p>说实话，我自己对未来好像也没有什么把握。当初自己在读《1Q84》的时候，就很向往天吾那样的生活。当个数学教师，没事情的时候写写小说。</p>
<p>我自己也一样，一边写写代码，一边写写小说。同时不要每天都扑在电脑上，锻炼好身体。</p>
<p>其实时间是充足的。不要抱怨时间来不及，只要自己不要浪费时间就行了。有时候一天不写代码又有什么关系的？看一天书，踢一会足球，又怎么能叫浪费时间呢？</p>
<p>只要自己认为不是浪费时间就行了。</p>
<p>只要自己认为过的开心就行了。</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2012/03/15/栈的基本实现/" itemprop="url">
                栈的基本实现
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2012-03-15T17:29:23+08:00" content="2012-03-15">
            2012-03-15
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>以下代码是用c语言写的</p>
<p>1.栈的顺序存储结构实现完成的基本功能</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#include &amp;lt;stdio.h&amp;gt;</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> MaxSize 100</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> ElemType int</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> </span><br><span class="line">&#123;</span><br><span class="line">	ElemType data[MaxSize];</span><br><span class="line">	<span class="keyword">int</span> top;</span><br><span class="line">&#125;SqStack;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitStack</span> <span class="params">(SqStack **s)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ClearStack</span> <span class="params">(SqStack **s)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span>  <span class="title">StackLength</span><span class="params">(SqStack *s)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Push</span> <span class="params">(SqStack *s, ElemType e)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Pop</span>  <span class="params">(SqStack *s, ElemType e)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DispStack</span> <span class="params">(SqStack *s)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> length;</span><br><span class="line">	ElemType e;</span><br><span class="line">	SqStack *s;</span><br><span class="line">	<span class="keyword">int</span> choose;</span><br><span class="line"></span><br><span class="line">	InitStack (&amp;amp;s);<span class="comment">//初始化栈</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(&amp;quot;<span class="number">1.</span>求栈的长度n2.进栈n3.出栈n4.退出并销毁栈n&amp;quot;);</span><br><span class="line">		<span class="built_in">printf</span>(&amp;quot;please choosen&amp;quot;);</span><br><span class="line">		<span class="built_in">scanf</span>(&amp;quot;%d&amp;quot;, &amp;amp;choose);</span><br><span class="line">		<span class="keyword">if</span> (choose == <span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			length = StackLength(s);<span class="comment">//求栈的长度</span></span><br><span class="line">			<span class="built_in">printf</span>(&amp;quot;栈的长度是%dn&amp;quot;, length);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (choose == <span class="number">2</span>)</span><br><span class="line">    		Push (s, e);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (choose == <span class="number">3</span>)</span><br><span class="line">			Pop(s, e);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (choose == <span class="number">4</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="built_in">printf</span>(&amp;quot;显示栈中的数据n&amp;quot;);</span><br><span class="line">		DispStack(s);<span class="comment">//每次循环时候打印栈中元素</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ClearStack(&amp;amp;s);<span class="comment">//销毁栈</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitStack</span> <span class="params">(SqStack **s)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	*s = (SqStack *) <span class="built_in">malloc</span> (<span class="keyword">sizeof</span>(SqStack));</span><br><span class="line">	(*s)-&amp;gt;top = -<span class="number">1</span>;<span class="comment">//初始化栈顶指针为-1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ClearStack</span> <span class="params">(SqStack **s)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="built_in">free</span>(*s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>  <span class="title">StackLength</span><span class="params">(SqStack *s)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (s-&amp;gt;top + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Push</span> <span class="params">(SqStack *s, ElemType e)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> data;</span><br><span class="line">	<span class="keyword">if</span> (s-&amp;gt;top == MaxSize - <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(&amp;quot;请输入进栈的数据n&amp;quot;);</span><br><span class="line">	<span class="built_in">scanf</span>(&amp;quot;%d&amp;quot;, &amp;amp;data);</span><br><span class="line">	s-&amp;gt;top++;</span><br><span class="line">	s-&amp;gt;data[s-&amp;gt;top] = data;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Pop</span><span class="params">(SqStack *s, ElemType e)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (s-&amp;gt;top == -<span class="number">1</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	e = s-&amp;gt;data[s-&amp;gt;top];</span><br><span class="line">	s-&amp;gt;top--;</span><br><span class="line">	<span class="built_in">printf</span>(&amp;quot;取出的元素为%dn&amp;quot;, e);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DispStack</span><span class="params">(SqStack *s)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">for</span> (i = s-&amp;gt;top; i &amp;gt;= <span class="number">0</span>; i-- )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(&amp;quot;%d  &amp;quot;, s-&amp;gt;data[i]);</span><br><span class="line">		<span class="built_in">printf</span>(&amp;quot;n&amp;quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.栈的链表存储结构实现完成的基本功能</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#include &amp;lt;stdio.h&amp;gt;</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> Elemtype int</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> linknode</span><br><span class="line">&#123;</span><br><span class="line">	Elemtype data;</span><br><span class="line">	<span class="keyword">struct</span> linknode *next;</span><br><span class="line">&#125;LiStack;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitStack</span><span class="params">(LiStack **s)</span></span>; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ClearStack</span><span class="params">(LiStack **s)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">StackLength</span><span class="params">(LiStack *s)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">StackEmpty</span><span class="params">(LiStack *s)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Push</span><span class="params">(LiStack **s, Elemtype e)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Pop</span> <span class="params">(LiStack **s, Elemtype e)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	LiStack *s;</span><br><span class="line">	Elemtype e;</span><br><span class="line">	<span class="keyword">int</span> choose;</span><br><span class="line"></span><br><span class="line">	InitStack(&amp;amp;s);<span class="comment">//初始化栈</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(&amp;quot;栈的链式存储结构n&amp;quot;);</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(&amp;quot;<span class="number">1.</span>获取栈的长度n2.判断是否为空栈n3.进栈n4.出栈n5.退出n&amp;quot;);</span><br><span class="line">		<span class="built_in">scanf</span>(&amp;quot;%d&amp;quot;, &amp;amp;choose);</span><br><span class="line">		<span class="keyword">switch</span>(choose)</span><br><span class="line">		&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">			<span class="built_in">printf</span>(&amp;quot;%dn&amp;quot;, StackLength(s));<span class="comment">//获取栈的长度</span></span><br><span class="line"></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">			<span class="keyword">if</span> (StackEmpty(s))<span class="comment">//判断是否为空栈</span></span><br><span class="line">				<span class="built_in">printf</span>(&amp;quot;是空栈n&amp;quot;);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="built_in">printf</span>(&amp;quot;不是空栈n&amp;quot;);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">			<span class="built_in">printf</span>(&amp;quot;请输入进栈数据n&amp;quot;);</span><br><span class="line">			<span class="built_in">scanf</span>(&amp;quot;%d&amp;quot;, &amp;amp;e);</span><br><span class="line">			Push(&amp;amp;s, e);<span class="comment">//进栈</span></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">			<span class="built_in">printf</span>(&amp;quot;出栈的数据为%dn&amp;quot;, Pop (&amp;amp;s, e));<span class="comment">//出栈</span></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	ClearStack(&amp;amp;s);<span class="comment">//摧毁栈</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitStack</span><span class="params">(LiStack **s)</span> </span><br><span class="line"></span>&#123;</span><br><span class="line">	*s = (LiStack *)<span class="built_in">malloc</span> (<span class="keyword">sizeof</span>(LiStack));</span><br><span class="line">	(*s)-&amp;gt;next = NULL;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ClearStack</span><span class="params">(LiStack **s)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	LiStack *p = (*s)-&amp;gt;next;</span><br><span class="line">	<span class="keyword">while</span>( p != NULL)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">free</span>(*s);</span><br><span class="line">		*s = p;</span><br><span class="line">		p = p-&amp;gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">free</span>(*s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">StackLength</span><span class="params">(LiStack *s)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	LiStack *p;</span><br><span class="line">	p = s-&amp;gt;next;</span><br><span class="line">	<span class="keyword">while</span>(p != NULL)</span><br><span class="line">	&#123;</span><br><span class="line">		i++;</span><br><span class="line">		p = p-&amp;gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span>(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">StackEmpty</span><span class="params">(LiStack *s)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (s-&amp;gt;next == NULL);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Push</span><span class="params">(LiStack **s, Elemtype e)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	LiStack *p;</span><br><span class="line"></span><br><span class="line">	p = (LiStack*) <span class="built_in">malloc</span> (<span class="keyword">sizeof</span>(LiStack));</span><br><span class="line">	p-&amp;gt;data = e;</span><br><span class="line">	p-&amp;gt;next = (*s)-&amp;gt;next;</span><br><span class="line">	(*s)-&amp;gt;next = p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Pop</span> <span class="params">(LiStack **s, Elemtype e)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	LiStack *p;</span><br><span class="line">	<span class="keyword">if</span> ((*s)-&amp;gt;next == NULL)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	p = (*s)-&amp;gt;next;</span><br><span class="line">	e = p-&amp;gt;data;</span><br><span class="line">	(*s)-&amp;gt;next = p-&amp;gt;next;</span><br><span class="line">	<span class="built_in">free</span>(p);</span><br><span class="line">	<span class="keyword">return</span> e;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2012/03/13/单向循环链表–约瑟夫环/" itemprop="url">
                单向循环链表–约瑟夫环
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2012-03-13T13:45:54+08:00" content="2012-03-13">
            2012-03-13
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>写个约瑟夫环，检验一下自己的学习情况&#8230;&#8230;&#8230;</p>
<p>```</p>
<h1 id="include">include</h1><h1 id="define_ElemType_int">define ElemType int</h1><p>typedef struct LNode{<br>ElemType data;<br>int num;<br>struct LNode *next;<br>}SqList;</p>
<p>void InitList(SqList _*L, ElemType n);<br>void Round(SqList _L, int m, int n);</p>
<p>int main()<br>{<br>SqList *L;<br>int n, m;<br>printf(“the first number m:n”);<br>scanf(“%d”, &amp;m);<br>printf(“the number of students:n”);<br>scanf(“%d”, &amp;n);<br>InitList(&amp;L, n);<br>Round(L, m, n);<br>free(L);<br>return 0;<br>}</p>
<p>void InitList(SqList _*L, ElemType n)//建立循环链表<br>{<br>SqList _s, _r;<br>int i;<br>ElemType a;
_L = (SqList _)malloc(sizeof(SqList));<br>r = _L;<br>scanf(“%d”, &amp;a);<br>(_L)-&gt;num = 1;<br>(_L)-&gt;data = a;</p>
<p>for (i = 1; i &lt; n; i++)//使用尾插法 { s = (SqList_)malloc(sizeof(SqList)); scanf(“%d”, &amp;a); s-&gt;data = a;<br>s-&gt;num = i + 1;<br>r-&gt;next = s;<br>r = s;<br>}<br>r-&gt;next = _L;<br>}</p>
<p>void Round(SqList *L, int m, int n)<br>{<br>int still = n;//still 里面存的是还有多少人<br>int count = 1;<br>while (still != 0)<br>{</p>
<p>if (m == 1)//处理密码是1的情况<br>{<br>printf(“%dn”,L-&gt;num);<br>m = L-&gt;data;<br>L-&gt;data = L-&gt;next-&gt;data;<br>L-&gt;num = L-&gt;next-&gt;num;<br>L-&gt;next = L-&gt;next-&gt;next;<br>count = 1;<br>still—;<br>continue;<br>}</p>
<p>else if (count == m - 1)//报到了的话<br>{<br>printf(“%dn”, L-&gt;next-&gt;num);//打印出列的数<br>m = L-&gt;next-&gt;data;//报的数要进行变化<br>L-&gt;next = L-&gt;next-&gt;next;//删除节点(注意这里应该是放在最后面来进行的)<br>still—;//总共参与的人数要相应的减少1<br>count = 1;//重新开始计数<br>L = L-&gt;next;<br>continue;<br>}</p>
<p>else<br>{<br>count++;<br>L = L-&gt;next;<br>}<br>}<br>}<br></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/16/">&laquo;</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><span class="page-number current">17</span><a class="page-number" href="/page/18/">18</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><a class="extend next" rel="next" href="/page/18/">&raquo;</a>
  </nav>


            </div>

            

            
        </div>

        
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/images/about me.JPG" alt="Miibotree" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Miibotree</p>
        </div>
        <p class="site-description motion-element" itemprop="description"></p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">211</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">1</span>
              <span class="site-state-item-name">分类</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">111</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


    </main>

    <footer id="footer" class="footer">
        <div class="footer-inner">
            <div class="copyright" >
  
  &copy; &nbsp; 
  <span itemprop="copyrightYear">2015</span>
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Miibotree</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



        </div>
    </footer>

    <div class="back-to-top"></div>
</div>

<script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  
  
  
  

  



  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.4"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.4"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.4" id="motion.global"></script>



  <script type="text/javascript" src="/js/search-toggle.js"></script>



<script type="text/javascript">
    $(document).ready(function () {
        if (CONFIG.sidebar === 'always') {
            displaySidebar();
        }
    });
</script>


<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
  });
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>



  
  

  







<!-- lazyload -->
<script type="text/javascript" src="/js/lazyload.js"></script>
<script type="text/javascript">
    jQuery(function () {
        jQuery("#posts img").lazyload({
            placeholder: "/images/loading.gif",
            effect: "fadeIn"
        });
    });
</script>
</body>
</html>
